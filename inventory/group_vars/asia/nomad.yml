nomad_version: "1.1.2"

nomad_config:
  region: "oikumene"
  datacenter: "asia"

  data_dir: "{{ nomad_dirs.data.path }}"

  bind_addr: "{{ main_ip }}"

  log_level: "warn"
  enable_syslog: true
  syslog_facility: "LOCAL5"

  server:
    enabled: true
    bootstrap_expect: 1
    encrypt: "{{ lookup('hashi_vault', 'secret-v1/gossip:nomad') }}"
    raft_protocol: 3

  client:
    enabled: true
    servers:
      - "nomad.service.asia.consul:4647"
    network_interface: "br0"

  consul:
    address: "consul.service.asia.consul:8500"

  plugin:
    docker:
      config:
        endpoint: "unix:///var/run/docker.sock"
        volumes:
          enabled: true
