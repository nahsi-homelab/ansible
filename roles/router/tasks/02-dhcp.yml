- name: install dnsmasq
  portage:
    package: net-dns/dnsmasq
    state: present

- name: copy dnsmasq config
  copy:
    content: "{{ router_dnsmasq_config }}"
    dest: "/etc/dnsmasq.conf"
    owner: dnsmasq
    group: dnsmasq
    mode: 0660
  notify: restart dnsmasq

- name: copy dnsmasq openrc config
  copy:
    content: "{{ router_dnsmasq_openrc_config }}"
    dest: "/etc/conf.d/dnsmasq"
    owner: root
    group: root
    mode: 0660
  notify: restart dnsmasq

- name: enable dnsmasq
  service:
    name: dnsmasq
    enabled: true
    runlevel: default
    use: openrc
