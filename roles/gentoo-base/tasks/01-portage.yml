- name: create portage directories
  file:
    dest: "{{ item }}"
    state: directory
    owner: root
    group: root
    mode: 0755
  loop:
    - /etc/portage/package.use
    - /etc/portage/package.mask
    - /etc/portage/package.accept_keywords
    - /etc/portage/repos.conf
    - /etc/portage/savedconfig
    - /etc/portage/env
    - /etc/portage/patches

- name: copy make.conf
  template:
    src: system/make.conf.j2
    dest: /etc/portage/make.conf
    owner: root
    group: root
    mode: 0644
  notify: update use

- name: set packages use flags
  copy:
    content: |
      {% for p in base_portage_package_use %}
      {{ p }}
      {% endfor %}
    dest: /etc/portage/package.use/ansible.use
    mode: 0644
  notify: update use
