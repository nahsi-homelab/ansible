consul_version: "1.9.8"

consul_servers:
  - 192.168.200.1

consul_private_address: !unsafe '{{ GetPrivateInterfaces | include "network" "192.168.200.0/24" | attr "address" }}'

consul_config_all:
  datacenter: "asia"
  encrypt: "{{ lookup('hashi_vault', 'secret/data/gossip:consul') }}"

  data_dir: "/var/lib/consul/"

  enable_syslog: true
  # "trace", "debug", "info", "warn", "err"
  log_level: "warn"
  syslog_facility: "LOCAL5"

  rejoin_after_leave: true

  bind_addr: "{{ consul_private_address }}"

  enable_local_script_checks: true

  server: false
  retry_join: "{{ consul_servers }}"
  retry_join_wan: "{{ consul_wan_servers }}"

consul_config: "{{ consul_config_all }}"
