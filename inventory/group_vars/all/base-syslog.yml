base_syslog_config: |
  config-version: "3.33"
  @include "/etc/syslog-ng/conf.d/*.conf"

  options {
    threaded(yes);
    chain_hostnames(no);
    use_dns(no);
    dns_cache(no);
    flush_lines(0);
    stats_freq(43200);
    mark_freq(3600);
  };

  source src {
    unix-stream("/dev/log" max-connections(256));
    internal();
  };
  source kernel {
    file("/proc/kmsg");
  };

  destination syslog {
    file("/var/log/syslog.log");
  };
  destination authlog {
    file("/var/log/auth.log");
  };
  destination cron {
    file("/var/log/cron.log");
  };
  destination daemon {
    file("/var/log/daemon.log");
  };
  destination kern {
    file("/var/log/kern.log");
  };
  destination lpr {
    file("/var/log/lpr.log");
  };
  destination user {
    file("/var/log/user.log");
  };
  destination mail {
    file("/var/log/mail.log");
  };
  destination news {
    file("/var/log/news.log");
  };
  destination debug {
    file("/var/log/debug");
  };
  destination messages {
    file("/var/log/messages");
  };
  destination console {
    usertty("root");
  };
  destination default {
    file("/var/log/all");
  };

  filter authpriv { facility(auth, authpriv); };
  filter syslog { not facility(authpriv, mail); };
  filter cron { facility(cron); };
  filter daemon { facility(daemon); };
  filter kern { facility(kern); };
  filter lpr { facility(lpr); };
  filter mail { facility(mail); };
  filter user { facility(user); };
  filter debug { not facility(auth, authpriv, news, mail); };
  filter messages { level(info..warn) and not facility(auth, authpriv, mail, news); };
  filter emergency { level(emerg); };
  filter info { level(info); };
  filter notice { level(notice); };
  filter warn { level(warn); };
  filter crit { level(crit); };
  filter err { level(err); };
  filter failed { message("failed"); };
  filter denied { message("denied"); };

  log {
    source(src);
    filter(authpriv);
    destination(authlog);
  };
  log {
    source(src);
    filter(syslog);
    destination(syslog);
  };
  log {
    source(src);
    filter(cron);
    destination(cron);
  };
  log {
    source(src);
    filter(daemon);
    destination(daemon);
  };
  log {
    source(kernel);
    filter(kern);
    destination(kern);
  };
  log {
    source(src);
    filter(lpr);
    destination(lpr);
  };
  log {
    source(src);
    filter(mail);
    destination(mail);
  };
  log {
    source(src);
    filter(user);
    destination(user);
  };
  log {
    source(src);
    filter(debug);
    destination(debug);
  };
  log {
    source(src);
    filter(messages);
    destination(messages);
  };
  log {
    source(src);
    filter(emergency);
    destination(console);
  };
  log {
    source(src);
    destination(default);
  };

base_syslog_configs: 
  promtail: |
    destination loki {
      syslog("localhost" transport("tcp") port(1514));
    };

    log {
      source(src);
      source(kernel);
      destination(loki);
    };

base_syslog_logrotate: |
  "/var/log/syslog.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/auth.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/cron.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/daemon.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/kern.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/lpr.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/user.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/mail.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/news.log" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/debug" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/messages" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
  "/var/log/all" {
      rotate 2
      weekly
      missingok
      notifempty
      maxsize 100M
      dateext
      postrotate
      /etc/init.d/syslog-ng reload > /dev/null 2>&1 || true
      endscript
  }
