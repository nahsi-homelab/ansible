kernel_boot_device: "/dev/disk/by-partlabel/EFI"

kernel_firmware:
  - amd/amd_sev_fam17h_model0xh.sbin
  - amd-ucode/microcode_amd_fam17h.bin

kernel_zfsbootmenu_config:
  Global:
    ManageImages: true
    BootMountPoint: /boot/efi
    DracutConfDir: /etc/zfsbootmenu/dracut.conf.d
  Components:
    ImageDir: /boot/efi/EFI/gentoo
    Versions: 1 # this will keep two versions, possibly a bug
    Enabled: true

kernel_refind_menu: |
  "Boot default" "root=zfsbootmenu:POOL=hot timeout=10 ro quiet loglevel=0"
  "Boot to menu" "root=zfsbootmenu:POOL=hot timeout=-1 ro quiet loglevel=0"

kernel_configs:
  01platform: |
    CONFIG_MZEN2=y

    CONFIG_SENSORS_AMD_ENERGY=y
    CONFIG_SENSORS_K10TEMP=y
    CONFIG_SENSORS_CORETEMP=y

    CONFIG_DMADEVICES=y
    CONFIG_INTEL_IOATDMA=y

  02network: |
    CONFIG_NET_VENDOR_INTEL=y
    CONFIG_IGB=y
    CONFIG_IGB_HWMON=y

  03ipmi: |
    CONFIG_RC_CORE=y

    CONFIG_DRM=y
    CONFIG_DRM_AST=y
    CONFIG_DRM_DP_CEC=y

    CONFIG_MEDIA_CEC_SUPPORT=y

    CONFIG_USB_NET_DRIVERS=y
    CONFIG_USB_USBNET=y
    CONFIG_USB_NET_CDCETHER=y

    CONFIG_ACPI_IPMI=y
    CONFIG_IPMI_DEVICE_INTERFACE=y
    CONFIG_IPMI_HANDLER=y
    CONFIG_IPMI_SI=y
    CONFIG_IPMI_SSIF=y
    CONFIG_IPMI_WATCHDOG=y
    CONFIG_IPMI_POWEROFF=y

  99firmware: |
    CONFIG_EXTRA_FIRMWARE_DIR="/lib/firmware"
    CONFIG_EXTRA_FIRMWARE="{{ kernel_firmware | join(' ') }}"
