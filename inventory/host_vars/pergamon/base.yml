base_consolefont: "ter-i24b"

base_filesystems:
  - path: "/var/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=75%,mode=1777"
    type: "tmpfs"
  - path: "/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=2G,mode=1777"
    type: "tmpfs"

base_sysctl:
  - name: vm.swappiness
    value: 1

base_network: |
  config_enp4s0="192.168.230.10/24"
  routes_enp4s0="default via 192.168.230.1"

base_network_interfaces:
  - name: "enp4s0"

base_packages_pergamon:
  - net-misc/r8168
  - media-plugins/hyperion
  - media-sound/beets
  - sys-power/apcupsd
  - media-tv/v4l-utils
  - media-video/v4l2loopback
  - media-video/obs-studio
  - media-gfx/inkscape
  - media-sound/easyeffects
  - app-emulation/vagrant
  - app-misc/deckmaster
  - media-video/obs-cli
base_packages: >
  {{
    base_packages_all +
    base_packages_pergamon +
    base_packages_desktop | unique
  }}

base_services:
  - name: "elogind"
    runlevel: "default"
  - name: "alsasound"
    runlevel: "default"
  - name: "docker"
    runlevel: "boot"

base_wireguard_configs:
  vpn: "{{ lookup('hashi_vault', 'secret/data/wireguard/pergamon:vpn') }}"
  office: "{{ lookup('hashi_vault', 'secret/data/wireguard/pergamon:office') }}"

base_wireguard_interfaces:
  - name: "vpn"
    enable: false
    start: false
  - name: "office"
    enable: false
    start: false

base_users_pergamon:
  - name: github
    comment: "GitHub actions runner user"
    create_home: false
    system: true
    groups:
      - docker
      - vboxusers
    append: true
    uid: 950
base_users: >
  {{
    base_users_all +
    base_users_pergamon | unique
  }}

base_udev_rules:
  10_streamdeck: |
    SUBSYSTEM=="usb", ATTRS{idVendor}=="0fd9", ATTRS{idProduct}=="0080", MODE:="660", GROUP="usb", SYMLINK+="streamdeck"
  11_moonlander: |
    SUBSYSTEM=="usb", ATTR{idVendor}=="3297", ATTR{idProduct}=="1969", GROUP="plugdev"
