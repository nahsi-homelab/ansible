base_consolefont: "ter-i24b"

base_filesystems:
  - path: "/var/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=75%,mode=1777"
    type: "tmpfs"
  - path: "/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=2G,mode=1777"
    type: "tmpfs"

base_sysctl:
  - name: vm.swappiness
    value: 1

base_network: |
  config_enp2s0="192.168.230.10/24"
  routes_enp2s0="default via 192.168.230.1"

base_network_interfaces:
  - name: "enp2s0"

base_containers_docker:
  default-runtime: "crun"
  runtimes:
    crun:
      path: "/usr/bin/crun"
  storage-driver: "zfs"
  storage-opts:
    - zfs.fsname=main/containers
  log-driver: "json-file"
  log-opts:
    max-size: "32m"
    max-file: "2"

base_containers_storage: |
  [storage]
  driver="zfs"
  runroot="/run/containers/storage"
  graphroot="/var/lib/containers/storage"
  [storage.options.zfs]
  fsname="main/containers"

base_packages_pergamon:
  - net-misc/r8168
base_packages: >
  {{
    base_packages_all +
    base_packages_pergamon +
    base_packages_desktop | unique
  }}

base_services:
  - name: "elogind"
    runlevel: "default"
  - name: "alsasound"
    runlevel: "default"
  - name: "docker"
    runlevel: "default"

base_wireguard_configs:
  syria: "{{ lookup('hashi_vault', 'secret/data/wireguard/pergamon:syria') }}"
  vpn: "{{ lookup('hashi_vault', 'secret/data/wireguard/pergamon:vpn') }}"
  office: "{{ lookup('hashi_vault', 'secret/data/wireguard/pergamon:office') }}"

base_wireguard_interfaces:
  - name: "syria"
    enable: false
    start: false
  - name: "vpn"
    enable: false
    start: false
  - name: "office"
    enable: false
    start: false
