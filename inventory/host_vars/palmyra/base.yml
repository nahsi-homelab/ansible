base_filesystems:
  - path: "/var/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=75%,mode=1777"
    type: "tmpfs"
  - path: "/tmp"
    src: "tmpfs"
    opts: "rw,nosuid,noatime,nodev,size=2G,mode=1777"
    type: "tmpfs"

base_sysctl:
  - name: net.ipv4.ip_forward
    value: 1
  - name: net.ipv6.conf.all.forwarding
    value: 1
  - name: net.ipv4.conf.default.rp_filter
    value: 1
  - name: vm.swappiness
    value: 1

base_network: |
  config_enp1s0="192.168.130.20/24"
  routes_enp1s0="default via 192.168.130.1"

base_network_interfaces:
  - name: "enp1s0"

base_packages_palmyra:
  - net-misc/r8168
  - sys-power/apcupsd
  - app-emulation/virtualbox
  - app-emulation/vagrant
base_packages: >
  {{
    base_packages_all +
    base_packages_palmyra | unique
  }}

base_services:
  - name: "docker"
    runlevel: "default"
    enabled: true
    state: "started"
  - name: "tailscale"
    runlevel: "default"
    enabled: true
    state: "started"

base_users_palmyra:
  - name: github
    comment: "GitHub actions runner user"
    create_home: false
    system: true
    groups:
      - docker
      - vboxusers
    append: true
    uid: 950
base_users: >
  {{
    base_users_all +
    base_users_palmyra | unique
  }}

base_udev_rules:
  10_virtualbox: |
    KERNEL=="vboxdrv", GROUP="vboxusers", MODE="0660"
    KERNEL=="vboxdrvu", GROUP="root", MODE="0666"
    KERNEL=="vboxnetctl", GROUP="vboxusers", MODE="0660"
