base_portage_makeconf_pergamon:
  COMMON_FLAGS: "-O2 -march=znver3"
  RUSTFLAGS: "-C target-cpu=znver3"
  CPU_FLAGS_X86: "aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sha sse sse2 sse3 sse4_1 sse4_2 sse4a ssse3"
  VIDEO_CARDS: "amdgpu radeonsi"
  INPUT_DEVICES: "evdev"
  LUA_TARGETS: "luajit"
  LUA_SINGLE_TARGET: "luajit"
  LLVM_TARGETS: "AMDGPU X86"
  FEATURES: "parallel-install"
  ACCEPT_LICENSE: "* google-chrome -@EULA"
base_portage_makeconf: >
  {{
    base_portage_makeconf_all |
    combine(base_portage_makeconf_pergamon, recursive=true)
  }}

base_portage_package_use_pergamon:
  system: |
    media-libs/mesa -classic -gles2

  pergamon: |
    media-plugins/hyperion -v4l -qt-grabber -zeroconf

    # xorg-server
    x11-libs/libdrm video_cards_radeon

    # messengers
    app-text/ghostscript-gpl cups

base_portage_package_use: >
  {{
    base_portage_package_use_pergamon |
    combine(base_portage_package_use_desktop, recursive=true) |
    combine(base_portage_package_use_all, recursive=true)
  }}

base_portage_use:
  - zstd
  - luajit
  - dist-kernel
  - X
  - elogind
  - -policykit
  - dri
  - drm
  - icu
  - xcb
  - -gtk
  - -gtk3
  - -sound
  - alsa
  - pipewire

  - vulkan
  - vaapi
  - vdpau
  - opengl

  - opus
  - ogg
  - vorbis
  - flac
  - gif
  - jpeg
  - png
  - webp
  - dts
